[
  {
    "ruleId": "",
    "ruleTitle": "Prevent SQL Injection",
    "type": "bad",
    "code": "// Vulnerable: concatenates user input directly into SQL\nimport { Pool } from 'pg'\nconst pool = new Pool()\n\nexport async function handler(req: any, res: any) {\n  const userId = req.query.id // attacker can supply \"1 OR 1=1\"\n  const sql = `SELECT id, username, email FROM users WHERE id = ${userId}`\n  const { rows } = await pool.query(sql)\n  res.json(rows)\n}",
    "language": "typescript",
    "description": "vulnerable SQL - Node.js / TypeScript"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent SQL Injection",
    "type": "good",
    "code": "// Safe: use parameterized queries to avoid SQL injection\nimport { Pool } from 'pg'\nconst pool = new Pool()\n\nexport async function handler(req: any, res: any) {\n  const userId = req.query.id\n  const sql = 'SELECT id, username, email FROM users WHERE id = $1'\n  const { rows } = await pool.query(sql, [userId])\n  res.json(rows)\n}",
    "language": "typescript",
    "description": "parameterized query - Node.js / TypeScript"
  }
]